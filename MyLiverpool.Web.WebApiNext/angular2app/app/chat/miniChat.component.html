<div class="block-minichat">
    <div class="blocktitle text-center">
        <b>Мини-чат</b>
    </div>
    <div class="blockcontent-inside">
        <div class="chatMessage-block">
            <div class="chat-message clearfix" *ngFor="let message of items; let i = index;">
                <div class="col-xs-12 col-sm-12 container-row clearfix">
                    <a [routerLink]="['/users', message.authorId]" [textContent]="message.authorUserName"></a>
                    <div class="pull-right" [textContent]="message.additionTime | date:'medium'"></div>
                    <span role="button" *ngIf="roles.isModerator || roles.isSelf(message.authorId)" (click)="edit(i)" class="glyphicon glyphicon-pencil"></span>
                    <span role="button" *ngIf="roles.isModerator" (click)="showDeleteModal(i)" class="glyphicon glyphicon-trash"></span>
                </div>
                <div class="col-xs-12 container-row" style="text-align: left;" [innerHTML]="sanitizeByHtml(message.message)">
                </div>
                <div class="col-xs-12 row">
                    <a role="button" (click)="addReply(i)"><span *ngIf="roles.isLogined && !roles.isSelf(message.authorId)" class="glyphicon glyphicon-share-alt"></span></a>
                </div>
            </div>
        </div>
        <form *ngIf="roles.isLogined" class="form-horizontal clearfix" name="messageForm" role="form" [formGroup]="messageForm" (ngSubmit)="onSubmit()">
            <div>
                <div class="col-xs-12 col-sm-12 container-row">
                    <bbeditor name="chat-message" [type]="3" [value]="messageForm.message" formControlName="message"></bbeditor>
                </div>
            </div>
            <div class="col-xs-12 col-sm-12 col-md-12 text-center container-row" style="margin-top: -37px;">            
                <button md-raised-button color="warn" type="submit" [disabled]="!messageForm.valid" class="chat-button">
                    <span *ngIf="selectedEditIndex == null">Добавить</span>
                    <span *ngIf="selectedEditIndex !== null">Обновить</span>
                </button>
                    <button md-raised-button *ngIf="selectedEditIndex !== null" type="button" (click)="cancelEdit()">Отмена</button>
                
            </div>
        </form>
        <div class="full-width text-center text-white flex-space-around top20">
            <div *ngIf="!roles.isLogined">Для добавления сообщений необходимо войти.</div>
            <form role="form" [formGroup]="chatTimerForm">
                <md-select placeholder="Автообновление" color="warn" formControlName="timerValue" (change)="updateSchedule($event)" style="background-color: white; padding-left: 5px;">
                    <md-option *ngFor="let interval of intervalArray" [value]="interval.value" [textContent]="interval.key"></md-option>
                </md-select>
            </form>
            <button type="button" (click)="update()"><span class="glyphicon glyphicon-refresh"></span></button>
        </div>

        <!--<div class="text-white">Уважаемый пользователь, чтобы получать уведомления об ответах на ваши комментарии под новостями, необходимо их включить в профиль-настройки.</div>-->
        <hr/>
        <user-online-counter></user-online-counter>
    <!--
    &nbsp;<a href="javascript://" rel="nofollow" onclick="new _uWnd('Sml',' ',-250,-350,{autosize:0,closeonesc:1,resize:0},{url:'/index/35-0-2'});return false;" title="Вставить смайл"><img alt="" border="0" align="absmiddle" src="http://s1.ucoz.net/img/fr/mcs.gif" width="13" height="15"></a>
            &nbsp;<a href="javascript://" rel="nofollow" onclick="window.open('/mchat/0-1','mchatCtrl','scrollbars=1,width=550,height=550,left=0,top=0');return false;" title="Управление сообщениями"><img alt="" border="0" align="absmiddle" src="http://s1.ucoz.net/img/fr/mcm.gif" width="15" height="15"></a>
    -->
</div>
</div>